var __extends=this&&this.__extends||function(d,b){function __(){this.constructor=d}for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p]);d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)};!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(exports,require("@angular/common"),require("@angular/core"),require("rxjs/Subject"),require("rxjs/observable/PromiseObservable"),require("rxjs/operator/toPromise"),require("rxjs/Observable")):"function"==typeof define&&define.amd?define(["exports","@angular/common","@angular/core","rxjs/Subject","rxjs/observable/PromiseObservable","rxjs/operator/toPromise","rxjs/Observable"],factory):factory((global.ng=global.ng||{},global.ng.router=global.ng.router||{}),global.ng.common,global.ng.core,global.Rx,global.Rx,global.Rx.Observable.prototype,global.Rx)}(this,function(exports,_angular_common,_angular_core,rxjs_Subject,rxjs_observable_PromiseObservable,rxjs_operator_toPromise){"use strict";function isPresent(obj){return void 0!==obj&&null!==obj}function isBlank(obj){return void 0===obj||null===obj}function isString(obj){return"string"==typeof obj}function isStringMap(obj){return"object"==typeof obj&&null!==obj}function isArray(obj){return Array.isArray(obj)}function noop(){}function stringify(token){if("string"==typeof token)return token;if(void 0===token||null===token)return""+token;if(token.name)return token.name;if(token.overriddenName)return token.overriddenName;var res=token.toString(),newLineIndex=res.indexOf("\n");return-1===newLineIndex?res:res.substring(0,newLineIndex)}function _flattenArray(source,target){if(isPresent(source))for(var i=0;i<source.length;i++){var item=source[i];isArray(item)?_flattenArray(item,target):target.push(item)}return target}function hasLifecycleHook(name,obj){if(isBlank(obj))return!1;var type=obj.constructor;return type instanceof Type?name in type.prototype:!1}function rootNode(tree){return tree._root}function _findNode(expected,c){if(expected===c.value)return c;for(var _i=0,_a=c.children;_i<_a.length;_i++){var cc=_a[_i],r=_findNode(expected,cc);if(isPresent(r))return r}return null}function _findPath(expected,c,collected){if(collected.push(c),expected===c.value)return collected;for(var _i=0,_a=c.children;_i<_a.length;_i++){var cc=_a[_i],r=_findPath(expected,cc,ListWrapper.clone(collected));if(isPresent(r))return r}return null}function _contains(tree,subtree){if(tree.value!==subtree.value)return!1;for(var _loop_1=function(subtreeNode){var s=tree.children.filter(function(child){return child.value===subtreeNode.value});return 0===s.length?{value:!1}:_contains(s[0],subtreeNode)?void 0:{value:!1}},_i=0,_a=subtree.children;_i<_a.length;_i++){var subtreeNode=_a[_i],state_1=_loop_1(subtreeNode);if("object"==typeof state_1)return state_1.value}return!0}function _serializeParams(params){var res="";return StringMapWrapper.forEach(params,function(v,k){return res+=";"+k+"="+v}),res}function createEmptyRouteTree(type){var root=new RouteSegment([new UrlSegment("",{},null)],{},DEFAULT_OUTLET_NAME,type,null);return new RouteTree(new TreeNode(root,[]))}function equalUrlSegments(a,b){if(a.length!==b.length)return!1;for(var i=0;i<a.length;++i){if(a[i].segment!=b[i].segment)return!1;if(a[i].outlet!=b[i].outlet)return!1;if(!StringMapWrapper.equals(a[i].parameters,b[i].parameters))return!1}return!0}function routeSegmentComponentFactory(a){return a._componentFactory}function link(segment,routeTree,urlTree,commands){if(0===commands.length)return urlTree;var normalizedCommands=_normalizeCommands(commands);if(_navigateToRoot(normalizedCommands))return new UrlTree(new TreeNode(urlTree.root,[]));var startingNode=_findStartingNode(normalizedCommands,urlTree,segment,routeTree),updated=normalizedCommands.commands.length>0?_updateMany(ListWrapper.clone(startingNode.children),normalizedCommands.commands):[],newRoot=_constructNewTree(rootNode(urlTree),startingNode,updated);return new UrlTree(newRoot)}function _navigateToRoot(normalizedChange){return normalizedChange.isAbsolute&&1===normalizedChange.commands.length&&"/"==normalizedChange.commands[0]}function _normalizeCommands(commands){if(isString(commands[0])&&1===commands.length&&"/"==commands[0])return new _NormalizedNavigationCommands(!0,0,commands);for(var numberOfDoubleDots=0,isAbsolute=!1,res=[],i=0;i<commands.length;++i){var c=commands[i];if(isString(c))for(var parts=c.split("/"),j=0;j<parts.length;++j){var cc=parts[j];0==i?0==j&&"."==cc||(0==j&&""==cc?isAbsolute=!0:".."==cc?numberOfDoubleDots++:""!=cc&&res.push(cc)):""!=cc&&res.push(cc)}else res.push(c)}return new _NormalizedNavigationCommands(isAbsolute,numberOfDoubleDots,res)}function _findUrlSegment(segment,routeTree,urlTree,numberOfDoubleDots){for(var s=segment;0===s.urlSegments.length;)s=routeTree.parent(s);var urlSegment=ListWrapper.last(s.urlSegments),path=urlTree.pathFromRoot(urlSegment);if(path.length<=numberOfDoubleDots)throw new BaseException$1("Invalid number of '../'");return path[path.length-1-numberOfDoubleDots]}function _findStartingNode(normalizedChange,urlTree,segment,routeTree){if(normalizedChange.isAbsolute)return rootNode(urlTree);var urlSegment=_findUrlSegment(segment,routeTree,urlTree,normalizedChange.numberOfDoubleDots);return _findMatchingNode(urlSegment,rootNode(urlTree))}function _findMatchingNode(segment,node){if(node.value===segment)return node;for(var _i=0,_a=node.children;_i<_a.length;_i++){var c=_a[_i],r=_findMatchingNode(segment,c);if(isPresent(r))return r}return null}function _constructNewTree(node,original,updated){return node===original?new TreeNode(node.value,updated):new TreeNode(node.value,node.children.map(function(c){return _constructNewTree(c,original,updated)}))}function _update(node,commands){var rest=commands.slice(1),next=0===rest.length?null:rest[0],outlet=_outlet(commands),segment=_segment(commands);if(isBlank(node)&&!isStringMap(next)){var urlSegment=new UrlSegment(segment,{},outlet),children=0===rest.length?[]:[_update(null,rest)];return new TreeNode(urlSegment,children)}if(isBlank(node)&&isStringMap(next)){var urlSegment=new UrlSegment(segment,_stringify(next),outlet);return _recurse(urlSegment,node,rest.slice(1))}if(outlet!=node.value.outlet)return node;if(isStringMap(segment)){var newSegment=new UrlSegment(node.value.segment,_stringify(segment),node.value.outlet);return _recurse(newSegment,node,rest)}if(isStringMap(next)&&_compare(segment,_stringify(next),node.value))return _recurse(node.value,node,rest.slice(1));if(isStringMap(next)){var urlSegment=new UrlSegment(segment,_stringify(next),outlet);return _recurse(urlSegment,node,rest.slice(1))}if(_compare(segment,{},node.value))return _recurse(node.value,node,rest);var urlSegment=new UrlSegment(segment,{},outlet);return _recurse(urlSegment,node,rest)}function _stringify(params){var res={};return StringMapWrapper.forEach(params,function(v,k){return res[k]=v.toString()}),res}function _compare(path,params,segment){return path==segment.segment&&StringMapWrapper.equals(params,segment.parameters)}function _recurse(urlSegment,node,rest){return 0===rest.length?new TreeNode(urlSegment,[]):new TreeNode(urlSegment,_updateMany(ListWrapper.clone(node.children),rest))}function _updateMany(nodes,commands){var outlet=_outlet(commands),nodesInRightOutlet=nodes.filter(function(c){return c.value.outlet==outlet});if(nodesInRightOutlet.length>0){var nodeRightOutlet=nodesInRightOutlet[0];nodes[nodes.indexOf(nodeRightOutlet)]=_update(nodeRightOutlet,commands)}else nodes.push(_update(null,commands));return nodes}function _segment(commands){if(!isString(commands[0]))return commands[0];var parts=commands[0].toString().split(":");return parts.length>1?parts[1]:commands[0]}function _outlet(commands){if(!isString(commands[0]))return null;var parts=commands[0].toString().split(":");return parts.length>1?parts[0]:null}function recognize(componentResolver,rootComponent,url,existingTree){var matched=new _MatchResult(rootComponent,[url.root],{},rootNode(url).children,[]);return _constructSegment(componentResolver,matched,rootNode(existingTree)).then(function(roots){return new RouteTree(roots[0])})}function _recognize(componentResolver,parentComponent,url,existingSegments){var metadata=_readMetadata(parentComponent);if(isBlank(metadata))throw new _angular_core.BaseException("Component '"+stringify(parentComponent)+"' does not have route configuration");var match;try{match=_match(metadata,url)}catch(e){return PromiseWrapper.reject(e,null)}var segmentsWithRightOutlet=existingSegments.filter(function(r){return r.value.outlet==match.outlet}),segmentWithRightOutlet=segmentsWithRightOutlet.length>0?segmentsWithRightOutlet[0]:null,main=_constructSegment(componentResolver,match,segmentWithRightOutlet),aux=_recognizeMany(componentResolver,parentComponent,match.aux,existingSegments).then(_checkOutletNameUniqueness);return PromiseWrapper.all([main,aux]).then(ListWrapper.flatten)}function _recognizeMany(componentResolver,parentComponent,urls,existingSegments){var recognized=urls.map(function(u){return _recognize(componentResolver,parentComponent,u,existingSegments)});return PromiseWrapper.all(recognized).then(ListWrapper.flatten)}function _constructSegment(componentResolver,matched,existingSegment){return componentResolver.resolveComponent(matched.component).then(function(factory){var segment=_createOrReuseSegment(matched,factory,existingSegment),existingChildren=isPresent(existingSegment)?existingSegment.children:[];return matched.leftOverUrl.length>0?_recognizeMany(componentResolver,factory.componentType,matched.leftOverUrl,existingChildren).then(function(children){return[new TreeNode(segment,children)]}):_recognizeLeftOvers(componentResolver,factory.componentType,existingChildren).then(function(children){return[new TreeNode(segment,children)]})})}function _createOrReuseSegment(matched,factory,segmentNode){var segment=isPresent(segmentNode)?segmentNode.value:null;return isPresent(segment)&&equalUrlSegments(segment.urlSegments,matched.consumedUrlSegments)&&StringMapWrapper.equals(segment.parameters,matched.parameters)&&segment.outlet==matched.outlet&&factory.componentType==segment.type?segment:new RouteSegment(matched.consumedUrlSegments,matched.parameters,matched.outlet,factory.componentType,factory)}function _recognizeLeftOvers(componentResolver,parentComponent,existingSegments){return componentResolver.resolveComponent(parentComponent).then(function(factory){var metadata=_readMetadata(factory.componentType);if(isBlank(metadata))return[];var r=metadata.routes.filter(function(r){return""==r.path||"/"==r.path});if(0===r.length)return PromiseWrapper.resolve([]);var segmentsWithMatchingOutlet=existingSegments.filter(function(r){return r.value.outlet==DEFAULT_OUTLET_NAME}),segmentWithMatchingOutlet_1=segmentsWithMatchingOutlet.length>0?segmentsWithMatchingOutlet[0]:null,existingChildren=isPresent(segmentWithMatchingOutlet_1)?segmentWithMatchingOutlet_1.children:[];return _recognizeLeftOvers(componentResolver,r[0].component,existingChildren).then(function(children){return componentResolver.resolveComponent(r[0].component).then(function(factory){var segment=_createOrReuseSegment(new _MatchResult(r[0].component,[],{},[],[]),factory,segmentWithMatchingOutlet_1);return[new TreeNode(segment,children)]})})})}function _match(metadata,url){for(var _i=0,_a=metadata.routes;_i<_a.length;_i++){var r=_a[_i],matchingResult=_matchWithParts(r,url);if(isPresent(matchingResult))return matchingResult}var availableRoutes=metadata.routes.map(function(r){return"'"+r.path+"'"}).join(", ");throw new _angular_core.BaseException("Cannot match any routes. Current segment: '"+url.value+"'. Available routes: ["+availableRoutes+"].")}function _matchWithParts(route,url){var path=route.path.startsWith("/")?route.path.substring(1):route.path;if("*"==path)return new _MatchResult(route.component,[],null,[],[]);for(var parts=path.split("/"),positionalParams={},consumedUrlSegments=[],lastParent=null,lastSegment=null,current=url,i=0;i<parts.length;++i){if(isBlank(current))return null;var p_1=parts[i],isLastSegment=i===parts.length-1,isLastParent=i===parts.length-2,isPosParam=p_1.startsWith(":");if(!isPosParam&&p_1!=current.value.segment)return null;isLastSegment&&(lastSegment=current),isLastParent&&(lastParent=current),isPosParam&&(positionalParams[p_1.substring(1)]=current.value.segment),consumedUrlSegments.push(current.value),current=ListWrapper.first(current.children)}var p=lastSegment.value.parameters,parameters=StringMapWrapper.merge(p,positionalParams),axuUrlSubtrees=isPresent(lastParent)?lastParent.children.slice(1):[];return new _MatchResult(route.component,consumedUrlSegments,parameters,lastSegment.children,axuUrlSubtrees)}function _checkOutletNameUniqueness(nodes){var names={};return nodes.forEach(function(n){var segmentWithSameOutletName=names[n.value.outlet];if(isPresent(segmentWithSameOutletName)){var p=segmentWithSameOutletName.stringifiedUrlSegments,c=n.value.stringifiedUrlSegments;throw new _angular_core.BaseException("Two segments cannot have the same outlet name: '"+p+"' and '"+c+"'.")}names[n.value.outlet]=n.value}),nodes}function _readMetadata(componentType){var metadata=reflector.annotations(componentType).filter(function(f){return f instanceof RoutesMetadata});return ListWrapper.first(metadata)}function _serializeUrlTreeNode(node){return""+node.value+_serializeChildren(node)}function _serializeUrlTreeNodes(nodes){var main=nodes[0].value.toString(),auxNodes=nodes.slice(1),aux=auxNodes.length>0?"("+auxNodes.map(_serializeUrlTreeNode).join("//")+")":"",children=_serializeChildren(nodes[0]);return""+main+aux+children}function _serializeChildren(node){return node.children.length>0?"/"+_serializeUrlTreeNodes(node.children):""}function matchUrlSegment(str){var match=RegExpWrapper.firstMatch(SEGMENT_RE,str);return isPresent(match)?match[0]:""}function matchUrlQueryParamValue(str){var match=RegExpWrapper.firstMatch(QUERY_PARAM_VALUE_RE,str);return isPresent(match)?match[0]:""}function routerFactory(app,componentResolver,urlSerializer,routerOutletMap,location){if(0==app.componentTypes.length)throw new _angular_core.BaseException("Bootstrap at least one component before injecting Router.");var router=new Router(null,app.componentTypes[0],componentResolver,urlSerializer,routerOutletMap,location);return app.registerDisposeListener(function(){return router.dispose()}),router}function routeSegmentFactory(router){return router.routeTree.root}var globalScope;globalScope="undefined"==typeof window?"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:global:window;var global$1=globalScope,Type=Function;global$1.assert=function(){};var NumberParseError=function(_super){function NumberParseError(message){_super.call(this),this.message=message}return __extends(NumberParseError,_super),NumberParseError.prototype.toString=function(){return this.message},NumberParseError}(Error),NumberWrapper=function(){function NumberWrapper(){}return NumberWrapper.toFixed=function(n,fractionDigits){return n.toFixed(fractionDigits)},NumberWrapper.equal=function(a,b){return a===b},NumberWrapper.parseIntAutoRadix=function(text){var result=parseInt(text);if(isNaN(result))throw new NumberParseError("Invalid integer literal when parsing "+text);return result},NumberWrapper.parseInt=function(text,radix){if(10==radix){if(/^(\-|\+)?[0-9]+$/.test(text))return parseInt(text,radix)}else if(16==radix){if(/^(\-|\+)?[0-9ABCDEFabcdef]+$/.test(text))return parseInt(text,radix)}else{var result=parseInt(text,radix);if(!isNaN(result))return result}throw new NumberParseError("Invalid integer literal when parsing "+text+" in base "+radix)},NumberWrapper.parseFloat=function(text){return parseFloat(text)},Object.defineProperty(NumberWrapper,"NaN",{get:function(){return 0/0},enumerable:!0,configurable:!0}),NumberWrapper.isNaN=function(value){return isNaN(value)},NumberWrapper.isInteger=function(value){return Number.isInteger(value)},NumberWrapper}(),RegExpWrapper=function(){function RegExpWrapper(){}return RegExpWrapper.create=function(regExpStr,flags){return void 0===flags&&(flags=""),flags=flags.replace(/g/g,""),new global$1.RegExp(regExpStr,flags+"g")},RegExpWrapper.firstMatch=function(regExp,input){return regExp.lastIndex=0,regExp.exec(input)},RegExpWrapper.test=function(regExp,input){return regExp.lastIndex=0,regExp.test(input)},RegExpWrapper.matcher=function(regExp,input){return regExp.lastIndex=0,{re:regExp,input:input}},RegExpWrapper.replaceAll=function(regExp,input,replace){var c=regExp.exec(input),res="";regExp.lastIndex=0;for(var prev=0;c;)res+=input.substring(prev,c.index),res+=replace(c),prev=c.index+c[0].length,regExp.lastIndex=prev,c=regExp.exec(input);return res+=input.substring(prev)},RegExpWrapper}(),PromiseCompleter=function(){function PromiseCompleter(){var _this=this;this.promise=new Promise(function(res,rej){_this.resolve=res,_this.reject=rej})}return PromiseCompleter}(),PromiseWrapper=function(){function PromiseWrapper(){}return PromiseWrapper.resolve=function(obj){return Promise.resolve(obj)},PromiseWrapper.reject=function(obj){return Promise.reject(obj)},PromiseWrapper.catchError=function(promise,onError){return promise.catch(onError)},PromiseWrapper.all=function(promises){return 0==promises.length?Promise.resolve([]):Promise.all(promises)},PromiseWrapper.then=function(promise,success,rejection){return promise.then(success,rejection)},PromiseWrapper.wrap=function(computation){return new Promise(function(res,rej){try{res(computation())}catch(e){rej(e)}})},PromiseWrapper.scheduleMicrotask=function(computation){PromiseWrapper.then(PromiseWrapper.resolve(null),computation,function(){})},PromiseWrapper.isPromise=function(obj){return obj instanceof Promise},PromiseWrapper.completer=function(){return new PromiseCompleter},PromiseWrapper}(),ObservableWrapper=function(){function ObservableWrapper(){}return ObservableWrapper.subscribe=function(emitter,onNext,onError,onComplete){return void 0===onComplete&&(onComplete=function(){}),onError="function"==typeof onError&&onError||noop,onComplete="function"==typeof onComplete&&onComplete||noop,emitter.subscribe({next:onNext,error:onError,complete:onComplete})},ObservableWrapper.isObservable=function(obs){return!!obs.subscribe},ObservableWrapper.hasSubscribers=function(obs){return obs.observers.length>0},ObservableWrapper.dispose=function(subscription){subscription.unsubscribe()},ObservableWrapper.callNext=function(emitter,value){emitter.next(value)},ObservableWrapper.callEmit=function(emitter,value){emitter.emit(value)},ObservableWrapper.callError=function(emitter,error){emitter.error(error)},ObservableWrapper.callComplete=function(emitter){emitter.complete()},ObservableWrapper.fromPromise=function(promise){return rxjs_observable_PromiseObservable.PromiseObservable.create(promise)},ObservableWrapper.toPromise=function(obj){return rxjs_operator_toPromise.toPromise.call(obj)},ObservableWrapper}(),EventEmitter=function(_super){function EventEmitter(isAsync){void 0===isAsync&&(isAsync=!1),_super.call(this),this.__isAsync=isAsync}return __extends(EventEmitter,_super),EventEmitter.prototype.emit=function(value){_super.prototype.next.call(this,value)},EventEmitter.prototype.next=function(value){_super.prototype.next.call(this,value)},EventEmitter.prototype.subscribe=function(generatorOrNext,error,complete){var schedulerFn,errorFn=function(){return null},completeFn=function(){return null};return generatorOrNext&&"object"==typeof generatorOrNext?(schedulerFn=this.__isAsync?function(value){setTimeout(function(){return generatorOrNext.next(value)})}:function(value){generatorOrNext.next(value)},generatorOrNext.error&&(errorFn=this.__isAsync?function(err){setTimeout(function(){return generatorOrNext.error(err)})}:function(err){generatorOrNext.error(err)}),generatorOrNext.complete&&(completeFn=this.__isAsync?function(){setTimeout(function(){return generatorOrNext.complete()})}:function(){generatorOrNext.complete()})):(schedulerFn=this.__isAsync?function(value){setTimeout(function(){return generatorOrNext(value)})}:function(value){generatorOrNext(value)},error&&(errorFn=this.__isAsync?function(err){setTimeout(function(){return error(err)})}:function(err){error(err)}),complete&&(completeFn=this.__isAsync?function(){setTimeout(function(){return complete()})}:function(){complete()})),_super.prototype.subscribe.call(this,schedulerFn,errorFn,completeFn)},EventEmitter}(rxjs_Subject.Subject),DEFAULT_OUTLET_NAME="__DEFAULT",Map$1=global$1.Map,Set=global$1.Set;!function(){try{if(1===new Map$1([[1,2]]).size)return function(pairs){return new Map$1(pairs)}}catch(e){}return function(pairs){for(var map=new Map$1,i=0;i<pairs.length;i++){var pair=pairs[i];map.set(pair[0],pair[1])}return map}}(),function(){try{if(new Map$1(new Map$1))return function(m){return new Map$1(m)}}catch(e){}return function(m){var map=new Map$1;return m.forEach(function(v,k){map.set(k,v)}),map}}(),function(){return(new Map$1).keys().next?function(m){for(var k,keyIterator=m.keys();!(k=keyIterator.next()).done;)m.set(k.value,null)}:function(m){m.forEach(function(v,k){m.set(k,null)})}}(),function(){try{if((new Map$1).values().next)return function(m,getValues){return getValues?Array.from(m.values()):Array.from(m.keys())}}catch(e){}return function(m,getValues){var res=ListWrapper.createFixedSize(m.size),i=0;return m.forEach(function(v,k){res[i]=getValues?v:k,i++}),res}}();var StringMapWrapper=function(){function StringMapWrapper(){}return StringMapWrapper.create=function(){return{}},StringMapWrapper.contains=function(map,key){return map.hasOwnProperty(key)},StringMapWrapper.get=function(map,key){return map.hasOwnProperty(key)?map[key]:void 0},StringMapWrapper.set=function(map,key,value){map[key]=value},StringMapWrapper.keys=function(map){return Object.keys(map)},StringMapWrapper.values=function(map){return Object.keys(map).reduce(function(r,a){return r.push(map[a]),r},[])},StringMapWrapper.isEmpty=function(map){for(var prop in map)return!1;return!0},StringMapWrapper.delete=function(map,key){delete map[key]},StringMapWrapper.forEach=function(map,callback){for(var prop in map)map.hasOwnProperty(prop)&&callback(map[prop],prop)},StringMapWrapper.merge=function(m1,m2){var m={};for(var attr in m1)m1.hasOwnProperty(attr)&&(m[attr]=m1[attr]);for(var attr in m2)m2.hasOwnProperty(attr)&&(m[attr]=m2[attr]);return m},StringMapWrapper.equals=function(m1,m2){var k1=Object.keys(m1),k2=Object.keys(m2);if(k1.length!=k2.length)return!1;for(var key,i=0;i<k1.length;i++)if(key=k1[i],m1[key]!==m2[key])return!1;return!0},StringMapWrapper}(),ListWrapper=function(){function ListWrapper(){}return ListWrapper.createFixedSize=function(size){return new Array(size)},ListWrapper.createGrowableSize=function(size){return new Array(size)},ListWrapper.clone=function(array){return array.slice(0)},ListWrapper.forEachWithIndex=function(array,fn){for(var i=0;i<array.length;i++)fn(array[i],i)},ListWrapper.first=function(array){return array?array[0]:null},ListWrapper.last=function(array){return array&&0!=array.length?array[array.length-1]:null},ListWrapper.indexOf=function(array,value,startIndex){return void 0===startIndex&&(startIndex=0),array.indexOf(value,startIndex)},ListWrapper.contains=function(list,el){return-1!==list.indexOf(el)},ListWrapper.reversed=function(array){var a=ListWrapper.clone(array);return a.reverse()},ListWrapper.concat=function(a,b){return a.concat(b)},ListWrapper.insert=function(list,index,value){list.splice(index,0,value)},ListWrapper.removeAt=function(list,index){var res=list[index];return list.splice(index,1),res},ListWrapper.removeAll=function(list,items){for(var i=0;i<items.length;++i){var index=list.indexOf(items[i]);list.splice(index,1)}},ListWrapper.remove=function(list,el){var index=list.indexOf(el);return index>-1?(list.splice(index,1),!0):!1},ListWrapper.clear=function(list){list.length=0},ListWrapper.isEmpty=function(list){return 0==list.length},ListWrapper.fill=function(list,value,start,end){void 0===start&&(start=0),void 0===end&&(end=null),list.fill(value,start,null===end?list.length:end)},ListWrapper.equals=function(a,b){if(a.length!=b.length)return!1;for(var i=0;i<a.length;++i)if(a[i]!==b[i])return!1;return!0},ListWrapper.slice=function(l,from,to){return void 0===from&&(from=0),void 0===to&&(to=null),l.slice(from,null===to?void 0:to)},ListWrapper.splice=function(l,from,length){return l.splice(from,length)},ListWrapper.sort=function(l,compareFn){isPresent(compareFn)?l.sort(compareFn):l.sort()},ListWrapper.toString=function(l){return l.toString()},ListWrapper.toJSON=function(l){return JSON.stringify(l)},ListWrapper.maximum=function(list,predicate){if(0==list.length)return null;for(var solution=null,maxValue=-1/0,index=0;index<list.length;index++){var candidate=list[index];if(!isBlank(candidate)){var candidateValue=predicate(candidate);candidateValue>maxValue&&(solution=candidate,maxValue=candidateValue)}}return solution},ListWrapper.flatten=function(list){var target=[];return _flattenArray(list,target),target},ListWrapper.addAll=function(list,source){for(var i=0;i<source.length;i++)list.push(source[i])},ListWrapper}();!function(){var test=new Set([1,2,3]);return 3===test.size?function(lst){return new Set(lst)}:function(lst){var res=new Set(lst);if(res.size!==lst.length)for(var i=0;i<lst.length;i++)res.add(lst[i]);return res}}();var BaseException$1=function(_super){function BaseException$1(message){void 0===message&&(message="--"),_super.call(this,message),this.message=message,this.stack=new Error(message).stack}return __extends(BaseException$1,_super),BaseException$1.prototype.toString=function(){return this.message},BaseException$1}(Error),Tree=function(){function Tree(root){this._root=root}return Object.defineProperty(Tree.prototype,"root",{get:function(){return this._root.value},enumerable:!0,configurable:!0}),Tree.prototype.parent=function(t){var p=this.pathFromRoot(t);return p.length>1?p[p.length-2]:null},Tree.prototype.children=function(t){var n=_findNode(t,this._root);return isPresent(n)?n.children.map(function(t){return t.value}):null},Tree.prototype.firstChild=function(t){var n=_findNode(t,this._root);return isPresent(n)&&n.children.length>0?n.children[0].value:null},Tree.prototype.pathFromRoot=function(t){return _findPath(t,this._root,[]).map(function(s){return s.value})},Tree.prototype.contains=function(tree){return _contains(this._root,tree._root)},Tree}(),UrlTree=function(_super){function UrlTree(root){_super.call(this,root)}return __extends(UrlTree,_super),UrlTree}(Tree),RouteTree=function(_super){function RouteTree(root){_super.call(this,root)}return __extends(RouteTree,_super),RouteTree}(Tree),TreeNode=function(){function TreeNode(value,children){this.value=value,this.children=children}return TreeNode}(),UrlSegment=function(){function UrlSegment(segment,parameters,outlet){this.segment=segment,this.parameters=parameters,this.outlet=outlet}return UrlSegment.prototype.toString=function(){var outletPrefix=isBlank(this.outlet)?"":this.outlet+":";return""+outletPrefix+this.segment+_serializeParams(this.parameters)},UrlSegment}(),RouteSegment=function(){function RouteSegment(urlSegments,parameters,outlet,type,componentFactory){this.urlSegments=urlSegments,this.parameters=parameters,this.outlet=outlet,this._type=type,this._componentFactory=componentFactory}return RouteSegment.prototype.getParam=function(param){return isPresent(this.parameters)?this.parameters[param]:null},RouteSegment.prototype.getParamAsNumber=function(param){return isPresent(this.parameters)?NumberWrapper.parseFloat(this.parameters[param]):null},Object.defineProperty(RouteSegment.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(RouteSegment.prototype,"stringifiedUrlSegments",{get:function(){return this.urlSegments.map(function(s){return s.toString()}).join("/")},enumerable:!0,configurable:!0}),RouteSegment}(),_NormalizedNavigationCommands=function(){function _NormalizedNavigationCommands(isAbsolute,numberOfDoubleDots,commands){this.isAbsolute=isAbsolute,this.numberOfDoubleDots=numberOfDoubleDots,this.commands=commands}return _NormalizedNavigationCommands}(),makeDecorator=_angular_core.__core_private__.makeDecorator,reflector=_angular_core.__core_private__.reflector,Route=function(){function Route(_a){var _b=void 0===_a?{}:_a,path=_b.path,component=_b.component;this.path=path,this.component=component}return Route.prototype.toString=function(){return"@Route("+this.path+", "+stringify(this.component)+")"},Route}(),RoutesMetadata=function(){function RoutesMetadata(routes){this.routes=routes}return RoutesMetadata.prototype.toString=function(){return"@Routes("+this.routes+")"},RoutesMetadata}(),_MatchResult=function(){function _MatchResult(component,consumedUrlSegments,parameters,leftOverUrl,aux){this.component=component,this.consumedUrlSegments=consumedUrlSegments,this.parameters=parameters,this.leftOverUrl=leftOverUrl,this.aux=aux}return Object.defineProperty(_MatchResult.prototype,"outlet",{get:function(){return 0===this.consumedUrlSegments.length||isBlank(this.consumedUrlSegments[0].outlet)?DEFAULT_OUTLET_NAME:this.consumedUrlSegments[0].outlet},enumerable:!0,configurable:!0}),_MatchResult}(),RouterOutletMap=function(){function RouterOutletMap(){this._outlets={}}return RouterOutletMap.prototype.registerOutlet=function(name,outlet){this._outlets[name]=outlet},RouterOutletMap}(),Router=function(){function Router(_rootComponent,_rootComponentType,_componentResolver,_urlSerializer,_routerOutletMap,_location){this._rootComponent=_rootComponent,this._rootComponentType=_rootComponentType,this._componentResolver=_componentResolver,this._urlSerializer=_urlSerializer,this._routerOutletMap=_routerOutletMap,this._location=_location,this._changes=new EventEmitter,this._routeTree=createEmptyRouteTree(this._rootComponentType),this._setUpLocationChangeListener(),this.navigateByUrl(this._location.path())}return Object.defineProperty(Router.prototype,"urlTree",{get:function(){return this._urlTree},enumerable:!0,configurable:!0}),Object.defineProperty(Router.prototype,"routeTree",{get:function(){return this._routeTree},enumerable:!0,configurable:!0}),Object.defineProperty(Router.prototype,"changes",{get:function(){return this._changes},enumerable:!0,configurable:!0}),Router.prototype.navigateByUrl=function(url){return this._navigate(this._urlSerializer.parse(url))},Router.prototype.navigate=function(commands,segment){return this._navigate(this.createUrlTree(commands,segment))},Router.prototype.dispose=function(){ObservableWrapper.dispose(this._locationSubscription)},Router.prototype.createUrlTree=function(commands,segment){var s=isPresent(segment)?segment:this._routeTree.root;return link(s,this._routeTree,this.urlTree,commands)},Router.prototype.serializeUrl=function(url){return this._urlSerializer.serialize(url)},Router.prototype._setUpLocationChangeListener=function(){var _this=this;this._locationSubscription=this._location.subscribe(function(change){_this._navigate(_this._urlSerializer.parse(change.url),change.pop)})},Router.prototype._navigate=function(url,preventPushState){var _this=this;return this._urlTree=url,recognize(this._componentResolver,this._rootComponentType,url,this._routeTree).then(function(currTree){return new _ActivateSegments(currTree,_this._routeTree).activate(_this._routerOutletMap,_this._rootComponent).then(function(updated){if(updated){if(_this._routeTree=currTree,isBlank(preventPushState)||!preventPushState){var path=_this._urlSerializer.serialize(_this._urlTree);_this._location.isCurrentPathEqualTo(path)?_this._location.replaceState(path):_this._location.go(path)}_this._changes.emit(null)}})})},Router}(),_ActivateSegments=function(){function _ActivateSegments(currTree,prevTree){this.currTree=currTree,this.prevTree=prevTree,this.deactivations=[],this.performMutation=!0}return _ActivateSegments.prototype.activate=function(parentOutletMap,rootComponent){var _this=this,prevRoot=isPresent(this.prevTree)?rootNode(this.prevTree):null,currRoot=rootNode(this.currTree);
return this.canDeactivate(currRoot,prevRoot,parentOutletMap,rootComponent).then(function(res){return _this.performMutation=!0,res&&_this.activateChildSegments(currRoot,prevRoot,parentOutletMap,[rootComponent]),res})},_ActivateSegments.prototype.canDeactivate=function(currRoot,prevRoot,outletMap,rootComponent){var _this=this;this.performMutation=!1,this.activateChildSegments(currRoot,prevRoot,outletMap,[rootComponent]);var allPaths=PromiseWrapper.all(this.deactivations.map(function(r){return _this.checkCanDeactivatePath(r)}));return allPaths.then(function(values){return values.filter(function(v){return v}).length===values.length})},_ActivateSegments.prototype.checkCanDeactivatePath=function(path){for(var _this=this,curr=PromiseWrapper.resolve(!0),_loop_2=function(p){curr=curr.then(function(_){return hasLifecycleHook("routerCanDeactivate",p)?p.routerCanDeactivate(_this.prevTree,_this.currTree):_})},_i=0,_a=ListWrapper.reversed(path);_i<_a.length;_i++){var p=_a[_i];_loop_2(p)}return curr},_ActivateSegments.prototype.activateChildSegments=function(currNode,prevNode,outletMap,components){var _this=this,prevChildren=isPresent(prevNode)?prevNode.children.reduce(function(m,c){return m[c.value.outlet]=c,m},{}):{};currNode.children.forEach(function(c){_this.activateSegments(c,prevChildren[c.value.outlet],outletMap,components),StringMapWrapper.delete(prevChildren,c.value.outlet)}),StringMapWrapper.forEach(prevChildren,function(v,k){return _this.deactivateOutlet(outletMap._outlets[k],components)})},_ActivateSegments.prototype.activateSegments=function(currNode,prevNode,parentOutletMap,components){var curr=currNode.value,prev=isPresent(prevNode)?prevNode.value:null,outlet=this.getOutlet(parentOutletMap,currNode.value);if(curr===prev)this.activateChildSegments(currNode,prevNode,outlet.outletMap,components.concat([outlet.component]));else if(this.deactivateOutlet(outlet,components),this.performMutation){var outletMap=new RouterOutletMap,component=this.activateNewSegments(outletMap,curr,prev,outlet);this.activateChildSegments(currNode,prevNode,outletMap,components.concat([component]))}},_ActivateSegments.prototype.activateNewSegments=function(outletMap,curr,prev,outlet){var resolved=_angular_core.ReflectiveInjector.resolve([{provide:RouterOutletMap,useValue:outletMap},{provide:RouteSegment,useValue:curr}]),ref=outlet.activate(routeSegmentComponentFactory(curr),resolved,outletMap);return hasLifecycleHook("routerOnActivate",ref.instance)&&ref.instance.routerOnActivate(curr,prev,this.currTree,this.prevTree),ref.instance},_ActivateSegments.prototype.getOutlet=function(outletMap,segment){var outlet=outletMap._outlets[segment.outlet];if(isBlank(outlet))throw segment.outlet==DEFAULT_OUTLET_NAME?new _angular_core.BaseException("Cannot find default outlet"):new _angular_core.BaseException("Cannot find the outlet "+segment.outlet);return outlet},_ActivateSegments.prototype.deactivateOutlet=function(outlet,components){var _this=this;isPresent(outlet)&&outlet.isActivated&&(StringMapWrapper.forEach(outlet.outletMap._outlets,function(v){return _this.deactivateOutlet(v,components)}),this.performMutation?outlet.deactivate():this.deactivations.push(components.concat([outlet.component])))},_ActivateSegments}(),RouterLink=function(){function RouterLink(_routeSegment,_router,_locationStrategy){var _this=this;this._routeSegment=_routeSegment,this._router=_router,this._locationStrategy=_locationStrategy,this._commands=[],this.isActive=!1,this._subscription=ObservableWrapper.subscribe(_router.changes,function(){_this._updateTargetUrlAndHref()})}return RouterLink.prototype.ngOnDestroy=function(){ObservableWrapper.dispose(this._subscription)},Object.defineProperty(RouterLink.prototype,"routerLink",{set:function(data){this._commands=isArray(data)?data:[data],this._updateTargetUrlAndHref()},enumerable:!0,configurable:!0}),RouterLink.prototype.onClick=function(button,ctrlKey,metaKey){return 0!=button||ctrlKey||metaKey?!0:isString(this.target)&&"_self"!=this.target?!0:(this._router.navigate(this._commands,this._routeSegment),!1)},RouterLink.prototype._updateTargetUrlAndHref=function(){var tree=this._router.createUrlTree(this._commands,this._routeSegment);isPresent(tree)?(this.href=this._locationStrategy.prepareExternalUrl(this._router.serializeUrl(tree)),this.isActive=this._router.urlTree.contains(tree)):this.isActive=!1},RouterLink}();RouterLink.decorators=[{type:_angular_core.Directive,args:[{selector:"[routerLink]"}]}],RouterLink.ctorParameters=[{type:RouteSegment},{type:Router},{type:_angular_common.LocationStrategy}],RouterLink.propDecorators={target:[{type:_angular_core.Input}],href:[{type:_angular_core.HostBinding}],isActive:[{type:_angular_core.HostBinding,args:["class.router-link-active"]}],routerLink:[{type:_angular_core.Input}],onClick:[{type:_angular_core.HostListener,args:["click",["$event.button","$event.ctrlKey","$event.metaKey"]]}]};var RouterOutlet=function(){function RouterOutlet(parentOutletMap,_location,name){this._location=_location,parentOutletMap.registerOutlet(isBlank(name)?DEFAULT_OUTLET_NAME:name,this)}return RouterOutlet.prototype.deactivate=function(){this._activated.destroy(),this._activated=null},Object.defineProperty(RouterOutlet.prototype,"component",{get:function(){return isPresent(this._activated)?this._activated.instance:null},enumerable:!0,configurable:!0}),Object.defineProperty(RouterOutlet.prototype,"isActivated",{get:function(){return isPresent(this._activated)},enumerable:!0,configurable:!0}),RouterOutlet.prototype.activate=function(factory,providers,outletMap){this.outletMap=outletMap;var inj=_angular_core.ReflectiveInjector.fromResolvedProviders(providers,this._location.parentInjector);return this._activated=this._location.createComponent(factory,this._location.length,inj,[]),this._activated},RouterOutlet}();RouterOutlet.decorators=[{type:_angular_core.Directive,args:[{selector:"router-outlet"}]}],RouterOutlet.ctorParameters=[{type:RouterOutletMap},{type:_angular_core.ViewContainerRef},{type:void 0,decorators:[{type:_angular_core.Attribute,args:["name"]}]}];var ROUTER_DIRECTIVES=[RouterOutlet,RouterLink],Routes=makeDecorator(RoutesMetadata),RouterUrlSerializer=function(){function RouterUrlSerializer(){}return RouterUrlSerializer}(),DefaultRouterUrlSerializer=function(_super){function DefaultRouterUrlSerializer(){_super.apply(this,arguments)}return __extends(DefaultRouterUrlSerializer,_super),DefaultRouterUrlSerializer.prototype.parse=function(url){var root=(new _UrlParser).parse(url);return new UrlTree(root)},DefaultRouterUrlSerializer.prototype.serialize=function(tree){return _serializeUrlTreeNode(rootNode(tree))},DefaultRouterUrlSerializer}(RouterUrlSerializer),SEGMENT_RE=RegExpWrapper.create("^[^\\/\\(\\)\\?;=&#]+"),QUERY_PARAM_VALUE_RE=RegExpWrapper.create("^[^\\(\\)\\?;&#]+"),_UrlParser=function(){function _UrlParser(){}return _UrlParser.prototype.peekStartsWith=function(str){return this._remaining.startsWith(str)},_UrlParser.prototype.capture=function(str){if(!this._remaining.startsWith(str))throw new _angular_core.BaseException('Expected "'+str+'".');this._remaining=this._remaining.substring(str.length)},_UrlParser.prototype.parse=function(url){return this._remaining=url,""==url||"/"==url?new TreeNode(new UrlSegment("",{},null),[]):this.parseRoot()},_UrlParser.prototype.parseRoot=function(){var segments=this.parseSegments();return new TreeNode(new UrlSegment("",{},null),segments)},_UrlParser.prototype.parseSegments=function(outletName){if(void 0===outletName&&(outletName=null),0==this._remaining.length)return[];this.peekStartsWith("/")&&this.capture("/");var path=matchUrlSegment(this._remaining);if(this.capture(path),path.indexOf(":")>-1){var parts=path.split(":");outletName=parts[0],path=parts[1]}var matrixParams={};this.peekStartsWith(";")&&(matrixParams=this.parseMatrixParams());var aux=[];this.peekStartsWith("(")&&(aux=this.parseAuxiliaryRoutes());var children=[];this.peekStartsWith("/")&&!this.peekStartsWith("//")&&(this.capture("/"),children=this.parseSegments());var segment=new UrlSegment(path,matrixParams,outletName),node=new TreeNode(segment,children);return[node].concat(aux)},_UrlParser.prototype.parseQueryParams=function(){var params={};for(this.capture("?"),this.parseQueryParam(params);this._remaining.length>0&&this.peekStartsWith("&");)this.capture("&"),this.parseQueryParam(params);return params},_UrlParser.prototype.parseMatrixParams=function(){for(var params={};this._remaining.length>0&&this.peekStartsWith(";");)this.capture(";"),this.parseParam(params);return params},_UrlParser.prototype.parseParam=function(params){var key=matchUrlSegment(this._remaining);if(!isBlank(key)){this.capture(key);var value="true";if(this.peekStartsWith("=")){this.capture("=");var valueMatch=matchUrlSegment(this._remaining);isPresent(valueMatch)&&(value=valueMatch,this.capture(value))}params[key]=value}},_UrlParser.prototype.parseQueryParam=function(params){var key=matchUrlSegment(this._remaining);if(!isBlank(key)){this.capture(key);var value="true";if(this.peekStartsWith("=")){this.capture("=");var valueMatch=matchUrlQueryParamValue(this._remaining);isPresent(valueMatch)&&(value=valueMatch,this.capture(value))}params[key]=value}},_UrlParser.prototype.parseAuxiliaryRoutes=function(){var segments=[];for(this.capture("(");!this.peekStartsWith(")")&&this._remaining.length>0;)segments=segments.concat(this.parseSegments("aux")),this.peekStartsWith("//")&&this.capture("//");return this.capture(")"),segments},_UrlParser}(),ROUTER_PROVIDERS_COMMON=[RouterOutletMap,{provide:RouterUrlSerializer,useClass:DefaultRouterUrlSerializer},{provide:_angular_common.LocationStrategy,useClass:_angular_common.PathLocationStrategy},_angular_common.Location,{provide:Router,useFactory:routerFactory,deps:[_angular_core.ApplicationRef,_angular_core.ComponentResolver,RouterUrlSerializer,RouterOutletMap,_angular_common.Location]},{provide:RouteSegment,useFactory:routeSegmentFactory,deps:[Router]}],ROUTER_PROVIDERS=[ROUTER_PROVIDERS_COMMON];exports.ROUTER_DIRECTIVES=ROUTER_DIRECTIVES,exports.RouterLink=RouterLink,exports.RouterOutlet=RouterOutlet,exports.Routes=Routes,exports.Route=Route,exports.Router=Router,exports.RouterOutletMap=RouterOutletMap,exports.ROUTER_PROVIDERS=ROUTER_PROVIDERS,exports.DefaultRouterUrlSerializer=DefaultRouterUrlSerializer,exports.RouterUrlSerializer=RouterUrlSerializer,exports.RouteSegment=RouteSegment,exports.RouteTree=RouteTree,exports.Tree=Tree,exports.UrlSegment=UrlSegment,exports.UrlTree=UrlTree});